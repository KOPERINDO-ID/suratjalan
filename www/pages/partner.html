<div class="page" data-name="partner-page">
    <div class="page-content theme-dark">
        <!-- Text Marquee -->
        <!-- <div class="card table-color-red border-actived" style="height:30px;">
            <marquee direction="left" style="vertical-align:middle; " id="data_surat_jalan_berjalan">
            </marquee>
        </div> -->

        <!-- Top Menu -->
        <div class="card">
            <div class="row no-gap">
                <div class="col-50" id="menu_surat_jalan">
                    <div
                        class="display-flex justify-content-center align-items-center padding-vertical-half bg-dark-gray-young text-bold">
                        <a class="text-add-colour-white" href="/surat_jalan">SURAT JALAN</a>
                    </div>
                </div>
                <div class="col-50" id="menu_partner">
                    <div
                        class="display-flex justify-content-center align-items-center padding-vertical-half bg-dark-gray-medium text-bold">
                        <a class="text-add-colour-white" href="/partner">PARTNER</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Table -->
        <div class="card border-actived">
            <div class="card-header bg-dark-gray-young" style="height: 32px;">
                <div class="data-table-title">
                    <h3>Data | <i id="jumlah_data_partner"> </i></h3>
                </div>
                <div class="display-flex align-content-center" style="gap: 4px;">
                    <i class="text-align-right f7-icons" onclick="historyData();"
                        style="font-size:30px; color:#fff;">clock_fill</i>
                    <i class="text-align-right f7-icons" onclick="muatUlangData();"
                        style="font-size:30px; color:#009100;">arrow_2_circlepath_circle_fill</i>
                </div>
            </div>

            <table width="100%">
                <tr>
                    <th style="padding:0px;" width="50%">
                        <center>
                            <input onkeyup="cariPerusahaan();" type="text"
                                style="border-radius:3px; padding:6px; width:100%;  color:black; background-color:lightgray;"
                                id="filter_perusahaan_partner" name="filter_perusahaan_partner" placeholder="Cari Data">
                        </center>
                    </th>
                </tr>
            </table>
            <div class="card-content" style="overflow-x:auto;">
                <table align="center" cellspacing="1" cellpadding="1" width="100%" id="table_surat_jalan">
                    <thead class="bg-dark-gray-medium text-align-center">
                        <tr>
                            <th class="label-cell" style="border-bottom:1px solid gray;">SPK</th>
                            <th class="label-cell" style="border-bottom:1px solid gray;">Perusahaan</th>
                            <th class="label-cell" style="border-bottom:1px solid gray;">Partner</th>
                            <th class="label-cell" style="border-bottom:1px solid gray;">Deadline</th>
                            <th class="label-cell" style="border-bottom:1px solid gray;">Aksi</th>
                        </tr>
                    </thead>
                    <tbody class="text-align-center" id="data_partner">
                    </tbody>
                </table>
            </div>
            <div id="tombol_paginasi" class="text-align-center" style="font-size:16px; width: 100%; display: block;">
            </div>
        </div>

        <!-- Popup History -->
        <div class="popup popup-history">
            <div class="view">
                <div class="page">
                    <div class="navbar">
                        <div class="navbar-bg bg-dark-gray-medium"></div>
                        <div class="navbar-inner bg-dark-gray-medium">
                            <div class="title">History Pengiriman</div>
                            <div class="right">
                                <a href="#" class="link popup-close">
                                    <i class="f7-icons" style="color: #fff;">xmark_rectangle_fill</i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="page-content">
                        <div class="card border-actived">
                            <div class="card-header bg-dark-gray-young" style="height: 32px;">
                                <div class="data-table-title">
                                    <h3>History | <span id="jumlah_history_data">0</span></h3>
                                </div>
                            </div>
                            <div class="card-content" style="overflow-x:auto;">
                                <table align="center" cellspacing="1" cellpadding="1" width="100%">
                                    <thead class="bg-dark-gray-medium text-align-center">
                                        <tr>
                                            <th class="label-cell" style="border-bottom:1px solid gray;">SPK</th>
                                            <th class="label-cell" style="border-bottom:1px solid gray;">Perusahaan</th>
                                            <th class="label-cell" style="border-bottom:1px solid gray;">Partner</th>
                                            <th class="label-cell" style="border-bottom:1px solid gray;">Deadline</th>
                                            <th class="label-cell" style="border-bottom:1px solid gray;">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody class="text-align-center" id="data_history_partner">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Popup Material -->
        <div class="popup popup-material">
            <div class="view view-init">
                <div class="page">
                    <div class="navbar">
                        <div class="navbar-bg"></div>
                        <div class="navbar-inner bg-dark-gray-medium">
                            <div class="title">Material</div>
                            <div class="right">
                                <!-- Link to close popup -->
                                <a class="link popup-close" id="close_material_modal" data-popup=".popup-material"
                                    onclick="cancelReceiving();">
                                    <i class="f7-icons" style="margin-right:5px; color: #fff;">xmark_rectangle_fill</i>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="page-content">
                        <div class="card card-outline margin-top">
                            <div class="card-content">
                                <div class="row">
                                    <div class="col-100">
                                        <div class="card">

                                            <!-- Header Information -->
                                            <div class="information-card-header col-100"
                                                style="margin-bottom: 10px; padding: 10px;">
                                                <div class="spk-info">
                                                    <div class="spk-code" id="material-spk-code"
                                                        style="font-weight: bold; font-size: 16px;">-
                                                    </div>
                                                    <div class="client-name" id="material-partner-name"
                                                        style="color: #1C1C1D;">-</div>
                                                </div>
                                                <div class="quantity-badge" id="material-quantity">
                                                    0 pcs
                                                </div>
                                            </div>

                                            <!-- Header Action -->
                                            <div class="col-100"
                                                style="background-color: #CFECFE; overflow-x: auto; padding: 10px; margin-bottom: 10px; border-radius: 4px;">
                                                <div
                                                    style="display: flex; justify-content: space-between; align-items: center;">
                                                    <!-- Left: Material Title & Count -->
                                                    <div
                                                        style="display: flex; align-items: center; gap: 10px; color: #1C1C1D;">
                                                        <div
                                                            style="font-weight: bold; font-size: 16px; padding-right: 10px; border-right: 1px solid #1C1C1D;">
                                                            Material</div>
                                                        <div style="font-size: 14px;" id="material_count">0 item</div>
                                                    </div>

                                                    <!-- Right: Action Buttons -->
                                                    <div style="display: flex; gap: 8px;">
                                                        <!-- Refresh Button -->
                                                        <button
                                                            class="button button-small button-fill color-green display-flex justify-content-end align-items-center"
                                                            id="btn_refresh_material" onclick="refreshMaterialData();"
                                                            style="height: 32px;">
                                                            <i class="f7-icons"
                                                                style="font-size: 18px;">arrow_clockwise</i>
                                                        </button>

                                                        <!-- Add Button -->
                                                        <button
                                                            class="button button-small button-fill color-green display-flex justify-content-end align-items-center"
                                                            id="btn_add_material" onclick="addMaterialRow();"
                                                            style="height: 32px;">
                                                            <i class="f7-icons" style="font-size: 18px;">plus</i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Material Table -->
                                            <div class="col-100" style="overflow-x: auto;">
                                                <table width="100%"
                                                    style="border-collapse: collapse; border: 1px solid #ddd;"
                                                    id="material_table">
                                                    <thead class="table-header-theme">
                                                        <tr>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 25px;">
                                                                No
                                                            </th>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 100px;">
                                                                Tanggal
                                                            </th>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 120px;">
                                                                Material
                                                            </th>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 100px;">
                                                                Jumlah
                                                            </th>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 120px;">
                                                                Harga
                                                            </th>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 100px;">
                                                                Aksi
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="table-body-theme" id="material_table_body">
                                                        <!-- Data will be rendered by JavaScript -->
                                                        <tr>
                                                            <td colspan="6" align="center"
                                                                style="padding: 20px; border: 1px solid #ddd;">
                                                                <i class="f7-icons"
                                                                    style="font-size: 40px; color: #999;">cube_box</i>
                                                                <p style="color: #999; margin-top: 10px;">Belum ada data
                                                                    material</p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Photo Upload Popup -->
        <div class="popup popup-photo-upload">
            <div class="view view-init">
                <div class="page">
                    <div class="navbar">
                        <div class="navbar-bg"></div>
                        <div class="navbar-inner bg-dark-gray-medium">
                            <div class="title">Upload Bukti Kirim</div>
                            <div class="right">
                                <a class="link popup-close" data-popup=".popup-photo-upload">
                                    <i class="f7-icons" style="color: #fff;">xmark_rectangle_fill</i>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="page-content">
                        <div class="card">
                            <div class="card-content">
                                <div class="row">
                                    <div class="col-100">
                                        <div class="card">
                                            <!-- Header Information -->
                                            <div class="information-card-header col-100"
                                                style="margin-bottom: 10px; padding: 10px;">
                                                <div class="spk-info">
                                                    <div class="spk-code" id="photo-spk-code"
                                                        style="font-weight: bold; font-size: 16px;">-</div>
                                                    <div class="client-name" id="photo-partner-name"
                                                        style="color: #666;">-</div>
                                                </div>
                                                <div class="quantity-badge" id="photo-purchase-qty">
                                                    0 pcs
                                                </div>
                                            </div>

                                            <!-- Table Summary -->
                                            <div style="overflow-x: auto; width: 100%; margin-bottom: 10px;">
                                                <table align="center" width="100%"
                                                    style="border-collapse: collapse; border:1px solid gray;"
                                                    border="1">
                                                    <thead class="table-header-theme text-align-center">
                                                        <tr>
                                                            <td align="center" width="40%"
                                                                style="padding: 8px; font-weight: bold;">
                                                                Material
                                                            </td>
                                                            <td align="center" width="20%"
                                                                style="padding: 8px; font-weight: bold;">
                                                                Jumlah
                                                            </td>
                                                            <td align="center" width="20%"
                                                                style="padding: 8px; font-weight: bold;">
                                                                Harga
                                                            </td>
                                                            <td align="center" width="20%"
                                                                style="padding: 8px; font-weight: bold;">
                                                                Total
                                                            </td>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="table-body-theme">
                                                        <tr>
                                                            <td class="label-cell text-align-left"
                                                                id="photo_type_purchase_tbl" style="padding: 8px;">
                                                                -
                                                            </td>
                                                            <td class="label-cell text-align-right"
                                                                id="photo_qty_purchase_tbl" style="padding: 8px;">
                                                                0
                                                            </td>
                                                            <td class="label-cell text-align-right"
                                                                id="photo_selesai_purchase_tbl" style="padding: 8px;">
                                                                0
                                                            </td>
                                                            <td class="label-cell text-align-right"
                                                                id="photo_sisa_purchase_tbl" style="padding: 8px;">0
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                            <!-- Photo Upload Area -->
                                            <div style="border: 1px solid #fff; border-radius: 4px; padding: 8px;">
                                                <input type="file" id="photo_upload_input" accept="image/*"
                                                    capture="camera" style="display: none;">

                                                <div id="photo_empty_placeholder" class="col-100"
                                                    style="display: none; padding: 32px 0px;">
                                                    <div class="display-flex flex-direction-column justify-content-space-between align-items-center"
                                                        style="color: #008000;">
                                                        <i class="f7-icons" style="font-size: 48px;">camera</i>
                                                        <h3 class="">BUKTI MATERIAL</h3>
                                                    </div>
                                                </div>

                                                <div id="photo_preview_area" style="display: none; margin: 8px 0px;">
                                                    <img id="photo_preview" src=""
                                                        style="width: 100%; max-height: 300px; object-fit: contain; border-radius: 8px;">
                                                </div>

                                                <button class="button button-fill button-large color-green"
                                                    id="btn_choose_photo" onclick="$('#photo_upload_input').click();"
                                                    style="width: 100%; margin-bottom: 10px;">
                                                    PILIH FOTO
                                                </button>

                                                <button class="button button-fill button-large color-blue"
                                                    id="btn_upload_photo" onclick="uploadMaterialPhoto();"
                                                    style="width: 100%; display: none;">
                                                    UNGGAH
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Photo Viewer Popup -->
        <div class="popup popup-photo-viewer">
            <div class="view view-init">
                <div class="page">
                    <div class="navbar">
                        <div class="navbar-bg"></div>
                        <div class="navbar-inner bg-dark-gray-medium">
                            <div class="title">Bukti Kirim Material</div>
                            <div class="right">
                                <a class="link popup-close" data-popup=".popup-photo-viewer">
                                    <i class="f7-icons" style="color: #fff;">xmark_rectangle_fill</i>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="page-content">
                        <div class="card">
                            <div class="card-content" style="padding: 0;">
                                <img id="photo_viewer_image" src="" style="width: 100%; height: auto;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Popup Penerimaan -->
        <div class="popup popup-penerimaan">
            <div class="view view-init">
                <div class="page">
                    <div class="navbar">
                        <div class="navbar-bg"></div>
                        <div class="navbar-inner bg-dark-gray-medium">
                            <div class="title">Penerimaan</div>
                            <div class="right">
                                <!-- Link to close popup -->
                                <a class="link popup-close" id="close_penerimaan_modal" data-popup=".popup-penerimaan">
                                    <i class="f7-icons" style="margin-right:5px; color: #fff;">xmark_rectangle_fill</i>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="page-content">
                        <div class="card card-outline margin-top">
                            <div class="card-content">
                                <div class="row">
                                    <div class="col-100">
                                        <div class="card">

                                            <!-- Header Information -->
                                            <div class="information-card-header col-100"
                                                style="margin-bottom: 10px; padding: 10px;">
                                                <div class="spk-info">
                                                    <div class="spk-code" id="receiving-spk-code"
                                                        style="font-weight: bold; font-size: 16px;">-
                                                    </div>
                                                    <div class="client-name" id="receiving-partner-name"
                                                        style="color: #1C1C1D;">-</div>
                                                </div>
                                                <div class="quantity-badge" id="receiving-quantity">
                                                    0 pcs
                                                </div>
                                            </div>

                                            <!-- Header Action -->
                                            <div class="col-100"
                                                style="background-color: #CFECFE; overflow-x: auto; padding: 10px; margin-bottom: 10px; border-radius: 4px;">
                                                <div
                                                    style="display: flex; justify-content: space-between; align-items: center;">
                                                    <!-- Left: receiving Title & Count -->
                                                    <div
                                                        style="display: flex; align-items: center; gap: 10px; color: #1C1C1D;">
                                                        <div
                                                            style="font-weight: bold; font-size: 16px; padding-right: 10px; border-right: 1px solid #1C1C1D;">
                                                            Penerimaan</div>
                                                        <div style="font-size: 14px;" id="receiving_count">0 data</div>
                                                    </div>

                                                    <!-- Right: Action Buttons -->
                                                    <div style="display: flex; gap: 8px;">
                                                        <!-- Refresh Button -->
                                                        <button
                                                            class="button button-small button-fill color-green display-flex justify-content-end align-items-center"
                                                            id="btn_refresh_receiving" onclick="refreshReceivingData();"
                                                            style="height: 32px;">
                                                            <i class="f7-icons"
                                                                style="font-size: 18px;">arrow_clockwise</i>
                                                        </button>

                                                        <!-- Add Button -->
                                                        <button
                                                            class="button button-small button-fill color-green display-flex justify-content-end align-items-center"
                                                            id="btn_add_receiving" onclick="addReceivingRow();"
                                                            style="height: 32px;">
                                                            <i class="f7-icons" style="font-size: 18px;">plus</i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- receiving Table -->
                                            <div class="col-100" style="overflow-x: auto;">
                                                <table width="100%"
                                                    style="border-collapse: collapse; border: 1px solid #ddd;"
                                                    id="receiving_table">
                                                    <thead class="table-header-theme">
                                                        <tr>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 25px;">
                                                                No
                                                            </th>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 100px;">
                                                                Tanggal
                                                            </th>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 100px;">
                                                                Jumlah
                                                            </th>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 100px;">
                                                                Retur
                                                            </th>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D; min-width: 120px;">
                                                                Kurang
                                                            </th>
                                                            <th
                                                                style="padding: 12px; text-align: center; border: 1px solid #1C1C1D;">
                                                                Aksi
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="table-body-theme" id="receiving_table_body">
                                                        <!-- Data will be rendered by JavaScript -->
                                                        <tr>
                                                            <td colspan="5" align="center"
                                                                style="padding: 20px; border: 1px solid #ddd;">
                                                                <i class="f7-icons"
                                                                    style="font-size: 40px; color: #999;">cube_box</i>
                                                                <p style="color: #999; margin-top: 10px;">Belum ada data
                                                                </p>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Popup Upload Bukti Penerimaan -->
        <div class="popup popup-upload-penerimaan">
            <div class="view view-init">
                <div class="page">
                    <div class="navbar">
                        <div class="navbar-bg"></div>
                        <div class="navbar-inner bg-dark-gray-medium">
                            <div class="title">Upload Bukti Penerimaan</div>
                            <div class="right">
                                <a class="link popup-close" data-popup=".popup-upload-penerimaan">
                                    <i class="f7-icons" style="margin-right:5px; color: #fff;">xmark_rectangle_fill</i>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="page-content">
                        <div class="card card-outline margin-top">
                            <div class="card-content">
                                <div class="row">
                                    <div class="col-100">
                                        <div class="card">
                                            <!-- Info Penerimaan -->
                                            <div class="col-100" style="margin-bottom: 15px;">
                                                <table width="100%"
                                                    style="border-collapse: collapse; background-color: #CFECFE; border-radius: 8px; overflow: hidden;">
                                                    <thead class="table-header-theme">
                                                        <tr>
                                                            <td
                                                                style="padding: 12px; text-align: center; font-weight: bold; color: #1C1C1D; border-bottom: 1px solid #B3E0FA; width: 40%;">
                                                                Tanggal
                                                            </td>
                                                            <td
                                                                style="padding: 12px; text-align: center; font-weight: bold; color: #1C1C1D; border-bottom: 1px solid #B3E0FA;">
                                                                Jumlah
                                                            </td>
                                                            <td
                                                                style="padding: 12px; text-align: center; font-weight: bold; color: #1C1C1D;">
                                                                Penerima
                                                            </td>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="table-body-theme">
                                                        <tr>
                                                            <td style="padding: 12px; text-align: center; color: #1C1C1D; border-bottom: 1px solid #B3E0FA;"
                                                                id="upload_tanggal_display">
                                                                -
                                                            </td>
                                                            <td style="padding: 12px; text-align: center; color: #1C1C1D; border-bottom: 1px solid #B3E0FA;"
                                                                id="upload_jumlah_display">
                                                                -
                                                            </td>
                                                            <td style="padding: 12px; text-align: center; color: #1C1C1D;"
                                                                id="upload_penerima_display">
                                                                -
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                            <!-- Upload Bukti Penerimaan -->
                                            <div class="col-100" style="margin-bottom: 20px;">
                                                <div style="font-weight: bold; margin-bottom: 10px; font-size: 16px;">
                                                    Bukti Penerimaan <span style="color: red;">*</span>
                                                </div>

                                                <!-- Input file (hidden) -->
                                                <input type="file" id="input_bukti_penerimaan"
                                                    accept="image/jpeg,image/jpg,image/png" style="display: none;" />

                                                <!-- Empty State dengan 2 Tombol -->
                                                <div id="preview_bukti_penerimaan_empty"
                                                    style="border: 2px dashed #ddd; border-radius: 8px; padding: 20px; text-align: center; background-color: #fafafa;">
                                                    <i class="f7-icons"
                                                        style="font-size: 48px; color: #999;">camera_fill</i>
                                                    <p style="color: #999; margin: 10px 0 15px 0;">Upload Bukti
                                                        Penerimaan</p>

                                                    <!-- Tombol Upload -->
                                                    <div class="row"
                                                        style="gap: 10px; margin: 0 auto; max-width: 300px;">
                                                        <div class="col-50">
                                                            <button
                                                                class="button button-fill bg-color-green button-small display-flex justify-content-center align-items-center"
                                                                onclick="uploadFromGalleryPenerimaan()" type="button"
                                                                style="width: 100%; height: 40px;">
                                                                <i class="f7-icons"
                                                                    style="margin-right: 4px; font-size: 18px;">photo</i>
                                                                Galeri
                                                            </button>
                                                        </div>
                                                        <div class="col-50">
                                                            <button
                                                                class="button button-fill bg-color-green button-small display-flex justify-content-center align-items-center"
                                                                onclick="captureFromCameraPenerimaan()" type="button"
                                                                style="width: 100%; height: 40px;">
                                                                <i class="f7-icons"
                                                                    style="margin-right: 4px; font-size: 18px;">camera</i>
                                                                Kamera
                                                            </button>
                                                        </div>
                                                    </div>

                                                    <p style="color: #999; font-size: 12px; margin-top: 10px;">JPG,
                                                        JPEG, PNG (Max 10MB)</p>
                                                </div>

                                                <!-- Preview Area -->
                                                <div id="preview_bukti_penerimaan_area"
                                                    style="display: none; border: 2px solid #4CAF50; border-radius: 8px; padding: 15px; background-color: #fafafa;">
                                                    <img id="preview_bukti_penerimaan_img"
                                                        style="width: 100%; max-height: 300px; object-fit: contain; border-radius: 8px; margin-bottom: 10px;" />
                                                    <div style="text-align: center;">
                                                        <button
                                                            class="button button-small button-fill bg-color-red display-flex justify-content-center align-items-center"
                                                            onclick="clearBuktiPenerimaan()" type="button"
                                                            style="margin: 0 auto; max-width: 150px;">
                                                            <i class="f7-icons"
                                                                style="margin-right: 4px; font-size: 14px;">trash</i>
                                                            Hapus
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Action Buttons -->
                                            <div class="col-100" style="margin-top: 20px;">
                                                <button
                                                    class="button button-fill btn-primary-theme display-flex justify-content-center align-items-center"
                                                    id="btn_submit_penerimaan" onclick="submitPenerimaanWithFiles()"
                                                    style="width: 100%;">
                                                    Simpan
                                                </button>

                                                <button class="button button-large button-fill bg-color-red popup-close"
                                                    data-popup=".popup-upload-penerimaan"
                                                    style="width: 100%; margin-top: 10px;">
                                                    Batal
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Popup Viewer Bukti Penerimaan -->
        <div class="popup popup-viewer-penerimaan">
            <div class="view view-init">
                <div class="page">
                    <div class="navbar">
                        <div class="navbar-bg"></div>
                        <div class="navbar-inner bg-dark-gray-medium">
                            <div class="title">Bukti Penerimaan</div>
                            <div class="right">
                                <a class="link popup-close" data-popup=".popup-viewer-penerimaan">
                                    <i class="f7-icons" style="margin-right:5px; color: #fff;">xmark_rectangle_fill</i>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="page-content">
                        <div class="card card-outline margin-top">
                            <div class="card-content">
                                <div class="row">
                                    <div class="col-100">
                                        <div class="card">
                                            <!-- Info Penerimaan -->
                                            <div class="col-100" style="margin-bottom: 15px;">
                                                <table width="100%"
                                                    style="border-collapse: collapse; background-color: #CFECFE; border-radius: 8px; overflow: hidden;">
                                                    <thead class="table-header-theme">
                                                        <tr>
                                                            <td
                                                                style="padding: 12px; text-align: center; font-weight: bold; color: #1C1C1D; border-bottom: 1px solid #B3E0FA; width: 40%;">
                                                                Tanggal
                                                            </td>
                                                            <td
                                                                style="padding: 12px; text-align: center; font-weight: bold; color: #1C1C1D; border-bottom: 1px solid #B3E0FA;">
                                                                Jumlah
                                                            </td>
                                                            <td
                                                                style="padding: 12px; text-align: center; font-weight: bold; color: #1C1C1D;">
                                                                Penerima
                                                            </td>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="table-body-theme">
                                                        <tr>
                                                            <td style="padding: 12px; text-align: center; color: #1C1C1D; border-bottom: 1px solid #B3E0FA;"
                                                                id="viewer_tanggal_penerimaan">
                                                                -
                                                            </td>
                                                            <td style="padding: 12px; text-align: center; color: #1C1C1D; border-bottom: 1px solid #B3E0FA;"
                                                                id="viewer_jumlah_penerimaan">
                                                                -
                                                            </td>
                                                            <td style="padding: 12px; text-align: center; color: #1C1C1D;"
                                                                id="viewer_nama_penerima">
                                                                -
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                            <!-- Bukti Penerimaan (Foto) -->
                                            <div class="col-100" style="margin-bottom: 20px;">
                                                <div style="font-weight: bold; margin-bottom: 10px; font-size: 16px;">
                                                    Bukti Penerimaan
                                                </div>

                                                <!-- Empty State -->
                                                <div id="viewer_bukti_penerimaan_empty"
                                                    style="border: 2px dashed #ddd; border-radius: 8px; padding: 30px; text-align: center; background-color: #fafafa;">
                                                    <i class="f7-icons" style="font-size: 48px; color: #ccc;">photo</i>
                                                    <p style="color: #999; margin-top: 10px;">Tidak ada bukti penerimaan
                                                    </p>
                                                </div>

                                                <!-- Image Area -->
                                                <div id="viewer_bukti_penerimaan_area" style="display: none;">
                                                    <div
                                                        style="border: 1px solid #ddd; border-radius: 8px; padding: 10px; background-color: #fff; text-align: center;">
                                                        <img id="viewer_bukti_penerimaan_img"
                                                            style="max-width: 100%; max-height: 400px; border-radius: 8px; cursor: pointer;"
                                                            onclick="window.open(this.src, '_blank')" />
                                                    </div>
                                                    <!-- <div style="margin-top: 10px;">
                                                        <a id="viewer_bukti_penerimaan_download"
                                                            class="display-flex justify-content-center align-items-center btn-primary-theme"
                                                            style="margin: 8px 0px;" download target="_blank">
                                                            <i class="f7-icons"
                                                                style="margin-right: 4px;">arrow_down_doc</i> UNDUH
                                                        </a>
                                                    </div> -->
                                                </div>
                                            </div>

                                            <!-- Bukti Dokumen Penerimaan -->
                                            <div class="col-100" style="margin-bottom: 20px; display: none;">
                                                <div style="font-weight: bold; margin-bottom: 10px; font-size: 16px;">
                                                    Bukti Dokumen Penerimaan
                                                </div>

                                                <!-- Empty State -->
                                                <div id="viewer_bukti_dokumen_empty"
                                                    style="border: 2px dashed #ddd; border-radius: 8px; padding: 30px; text-align: center; background-color: #fafafa;">
                                                    <i class="f7-icons" style="font-size: 48px; color: #ccc;">doc</i>
                                                    <p style="color: #999; margin-top: 10px;">Tidak ada dokumen</p>
                                                </div>

                                                <!-- Document Area -->
                                                <div id="viewer_bukti_dokumen_area" style="display: none;">
                                                    <div
                                                        style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; background-color: #fff;">
                                                        <!-- Preview for images -->
                                                        <div style="text-align: center; margin-bottom: 10px;">
                                                            <img id="viewer_bukti_dokumen_img"
                                                                style="max-width: 100%; max-height: 300px; border-radius: 8px; display: none;" />
                                                            <i id="viewer_bukti_dokumen_icon" class="f7-icons"
                                                                style="font-size: 64px; color: #e53935; display: none;">doc_text_fill</i>
                                                        </div>
                                                        <div
                                                            style="text-align: center; padding: 10px; background-color: #f5f5f5; border-radius: 4px;">
                                                            <span id="viewer_bukti_dokumen_name"
                                                                style="font-size: 14px; color: #333;">-</span>
                                                        </div>
                                                    </div>
                                                    <!-- <div style="margin-top: 10px;">
                                                        <a id="viewer_bukti_dokumen_download"
                                                            class="display-flex justify-content-center align-items-center btn-primary-theme"
                                                            style="padding: 8px 0px;" download target="_blank">
                                                            <i class="f7-icons"
                                                                style="margin-right: 4px;">arrow_down_doc</i> UNDUH
                                                        </a>
                                                    </div> -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Popup Retur -->
        <div class="popup popup-retur">
            <div class="view view-init">
                <div class="page">
                    <div class="navbar">
                        <div class="navbar-bg"></div>
                        <div class="navbar-inner bg-dark-gray-medium">
                            <div class="title">Ex Retur</div>
                            <div class="right">
                                <a class="link popup-close" id="close_retur_modal" data-popup=".popup-retur">
                                    <i class="f7-icons" style="margin-right:5px; color: #fff;">xmark_rectangle_fill</i>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="page-content">
                        <div class="card card-outline margin-top">
                            <div class="card-content">
                                <div class="row">
                                    <div class="col-100">
                                        <div class="card">

                                            <!-- Header Information -->
                                            <div class="information-card-header col-100"
                                                style="margin-bottom: 10px; padding: 10px;">
                                                <div class="spk-info">
                                                    <div class="spk-code" id="retur-spk-code"
                                                        style="font-weight: bold; font-size: 16px;">-</div>
                                                    <div class="client-name" id="retur-partner-name"
                                                        style="color: #1C1C1D;">-</div>
                                                </div>
                                                <div class="quantity-badge" id="retur-jumlah-diterima">
                                                    0 pcs
                                                </div>
                                            </div>

                                            <!-- Header Action -->
                                            <!-- <div class="col-100"
                                                style="background-color: #CFECFE; overflow-x: auto; padding: 10px; margin-bottom: 10px; border-radius: 4px;">
                                                <div
                                                    style="display: flex; justify-content: space-between; align-items: center;">
                                                    <div
                                                        style="display: flex; align-items: center; gap: 10px; color: #1C1C1D;">
                                                        <div
                                                            style="font-weight: bold; font-size: 16px; padding-right: 10px; border-right: 1px solid #1C1C1D;">
                                                            Retur</div>
                                                        <div style="font-size: 14px;" id="retur_count">0 data</div>
                                                    </div>
                                                </div>
                                            </div> -->

                                            <!-- Retur Form -->
                                            <div class="col-100" style="padding: 10px;">

                                                <!-- Jumlah Retur -->
                                                <div style="margin-bottom: 12px;">
                                                    <label
                                                        style="display: block; font-size: 13px; color: #fff; margin-bottom: 4px; font-weight: 500;">
                                                        Jumlah Retur <span style="color: red;">*</span>
                                                        <span id="retur-max-label"
                                                            style="color: #888; font-weight: 400;">(maks: 0)</span>
                                                    </label>
                                                    <input type="number" id="input_jumlah_retur" placeholder="0" min="1"
                                                        value=""
                                                        style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;" />
                                                </div>


                                                <!-- Alasan Retur -->
                                                <div style="margin-bottom: 12px;">
                                                    <label
                                                        style="display: block; font-size: 13px; color: #fff; margin-bottom: 4px; font-weight: 500;">
                                                        Alasan Retur <span style="color: red;">*</span>
                                                    </label>
                                                    <select id="input_alasan_retur"
                                                        style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; background-color: #fff; appearance: auto;">
                                                        <option value="" disabled selected>-- Pilih Alasan --</option>
                                                        <option value="RUSAK">Rusak</option>
                                                        <option value="CACAT_PRODUKSI">Cacat Produksi</option>
                                                        <option value="TIDAK_SESUAI_SPEK">Tidak Sesuai Spek</option>
                                                        <option value="SALAH_KIRIM">Salah Kirim</option>
                                                        <option value="LAINNYA">Lainnya</option>
                                                    </select>
                                                </div>

                                                <!-- Keterangan -->
                                                <div style="margin-bottom: 12px;">
                                                    <label
                                                        style="display: block; font-size: 13px; color: #fff; margin-bottom: 4px; font-weight: 500;">
                                                        Keterangan
                                                    </label>
                                                    <textarea id="input_keterangan_retur"
                                                        placeholder="Tambahkan keterangan retur..." rows="3"
                                                        style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; resize: vertical; font-family: inherit;"></textarea>
                                                </div>

                                                <!-- Upload Foto Bukti Retur -->
                                                <div style="margin-bottom: 12px;">
                                                    <label
                                                        style="display: block; font-size: 13px; color: #fff; margin-bottom: 4px; font-weight: 500;">
                                                        Foto Bukti Retur
                                                    </label>

                                                    <!-- Hidden file input -->
                                                    <input type="file" id="input_foto_bukti_retur"
                                                        accept="image/jpeg,image/jpg,image/png"
                                                        style="display: none;" />

                                                    <!-- Upload Buttons -->
                                                    <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                                        <button class="button button-small button-fill color-blue"
                                                            onclick="uploadFromGalleryRetur()" style="flex: 1;">
                                                            <i class="f7-icons"
                                                                style="margin-right: 4px;">photo_on_rectangle</i>
                                                            Galeri
                                                        </button>
                                                        <button class="button button-small button-fill color-blue"
                                                            onclick="captureFromCameraRetur()" style="flex: 1;">
                                                            <i class="f7-icons" style="margin-right: 4px;">camera</i>
                                                            Kamera
                                                        </button>
                                                    </div>

                                                    <!-- Preview Area (hidden by default) -->
                                                    <div id="preview_foto_retur_area"
                                                        style="display: none; position: relative; margin-top: 8px;">
                                                        <img id="preview_foto_retur_img" src=""
                                                            alt="Preview Bukti Retur"
                                                            style="width: 100%; max-height: 200px; object-fit: cover; border-radius: 4px; border: 1px solid #ddd;" />
                                                        <!-- Remove button -->
                                                        <button class="button button-small button-fill color-red"
                                                            onclick="clearFotoBuktiRetur()"
                                                            style="position: absolute; top: 6px; right: 6px; height: 28px; min-width: 28px; padding: 0 6px;">
                                                            <i class="f7-icons" style="font-size: 16px;">xmark</i>
                                                        </button>
                                                    </div>

                                                    <!-- Empty placeholder -->
                                                    <div id="preview_foto_retur_empty"
                                                        style="border: 2px dashed #ccc; border-radius: 4px; padding: 16px; text-align: center; color: #999; font-size: 13px;">
                                                        <i class="f7-icons"
                                                            style="font-size: 28px; color: #bbb;">photo</i>
                                                        <p style="margin: 4px 0 0;">Belum ada foto</p>
                                                    </div>
                                                </div>

                                                <!-- Action Buttons -->
                                                <div style="display: flex; gap: 8px; margin-top: 16px;">
                                                    <button class="button button-fill color-green text-bold"
                                                        id="btn_submit_retur" onclick="submitRetur()" style="flex: 1;">
                                                        SIMPAN
                                                    </button>
                                                    <!-- <button class="button button-fill color-gray text-bold"
                                                        onclick="closeReturModal()" style="flex: 1;">
                                                        BATAL
                                                    </button> -->
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>